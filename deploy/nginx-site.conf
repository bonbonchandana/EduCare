server {
    listen 80;
    server_name example.com; # replace with your domain or server IP

    root /var/www/educare;
    index index.html;

    location /static/ {
        expires 30d;
    }

    # Serve single-page app files and fallback to index.html
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Proxy API requests to Gunicorn via unix socket
    location /predict {
        include proxy_params;
        proxy_pass http://unix:/var/www/educare/educare.sock:;
    }
    location /train { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }
    location /model_info { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }
    location /predictions_saved { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }
    location /download_predictions { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }
    location /reset_model { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }
    location /health { include proxy_params; proxy_pass http://unix:/var/www/educare/educare.sock:; }

    # Optional: large upload body size for file uploads
    client_max_body_size 50M;
}
